function sendCalendarToTelegram() {
  var calenda = CalendarApp.getCalendarById("xxx"); // ‡πÉ‡∏™‡πà Calendar ID ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£
  var token = 'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'; // ‡πÉ‡∏™‡πà Telegram bot token
  var chatId = 'xxxxxxxxxx'; // ‡πÉ‡∏™‡πà chat ID
  //https://api.telegram.org/bot/getUpdates
  var telegramUrl = 'https://api.telegram.org/bot' + token + '/sendMessage';
  
  // ‡∏î‡∏∂‡∏á‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏Ç‡∏≠‡∏á‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ
  var today = new Date(new Date().getFullYear(), new Date().getMonth(), new Date().getDate());
  var events = calenda.getEventsForDay(today);
  var message = "";
  
  if (events.length === 0) {
    message = "‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡πÉ‡∏ô‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô.";
  } else {
    message += "üìÖ ‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡∏°‡∏µ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î " + events.length + " ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ ‡πÑ‡∏î‡πâ‡πÅ‡∏Å‡πà:\n\n";
    message += formatEvents(events);
  }

  // ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• payload ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡πà‡∏á‡πÑ‡∏õ‡∏¢‡∏±‡∏á Telegram
  var payload = {
    'chat_id': chatId,
    'text': message,
    'parse_mode': 'Markdown' // ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô HTML ‡∏´‡∏≤‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£
  };

  var options = {
    'method': 'post',
    'contentType': 'application/json',
    'payload': JSON.stringify(payload)
  };

  // ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÑ‡∏õ‡∏ó‡∏µ‡πà Telegram
  try {
    var response = UrlFetchApp.fetch(telegramUrl, options);
    Logger.log(response.getContentText());
  } catch (error) {
    Logger.log('Error sending message: ' + error);
  }
}

function formatEvents(events) {
  var msg = "";
  events.forEach(function(event, index) {
    var title = event.getTitle();
    var start = event.getStartTime().getHours() + ":" + ("0" + event.getStartTime().getMinutes()).slice(-2);
    var end = event.getEndTime().getHours() + ":" + ("0" + event.getEndTime().getMinutes()).slice(-2);
    
    if (event.isAllDayEvent()) {
      msg += String(index + 1) + ") " + "‡πÄ‡∏ß‡∏•‡∏≤: ‡∏ó‡∏±‡πâ‡∏á‡∏ß‡∏±‡∏ô\n üî•‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á: " + title + "\n\n";
    } else {
      msg += String(index + 1) + ") " + "‡πÄ‡∏ß‡∏•‡∏≤: " + start + " - " + end + " ‡∏ô.\n üî•‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á: " + title + "\n\n";
    }
  });
  return msg;
}
